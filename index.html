<!doctype html>
<html lang="pl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>
      Kalkulator kosztów wideocalli + nagrywanie (Zoom Video SDK i porównanie)
    </title>
    <style>
      :root {
        color-scheme: light dark;
      }
      body {
        font-family:
          ui-sans-serif,
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          Arial,
          sans-serif;
        margin: 0;
        padding: 24px;
        line-height: 1.35;
      }
      .wrap {
        max-width: 1150px;
        margin: 0 auto;
      }
      h1 {
        font-size: 20px;
        margin: 0 0 12px;
      }
      .muted {
        opacity: 0.82;
        font-size: 13px;
      }
      .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        margin-top: 16px;
      }
      @media (max-width: 980px) {
        .grid {
          grid-template-columns: 1fr;
        }
      }
      .card {
        border: 1px solid rgba(127, 127, 127, 0.35);
        border-radius: 14px;
        padding: 16px;
        background: rgba(127, 127, 127, 0.06);
      }
      .card h2 {
        font-size: 16px;
        margin: 0 0 10px;
      }
      .row {
        display: grid;
        grid-template-columns: 1fr 180px;
        gap: 10px;
        align-items: center;
        margin: 8px 0;
      }
      .row label {
        font-size: 13px;
      }
      input[type="number"],
      select {
        width: 100%;
        padding: 8px 10px;
        border-radius: 10px;
        border: 1px solid rgba(127, 127, 127, 0.45);
        background: transparent;
      }
      .hint {
        font-size: 12px;
        opacity: 0.75;
        margin-top: 6px;
      }
      .kpi {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 10px;
      }
      @media (max-width: 700px) {
        .kpi {
          grid-template-columns: 1fr;
        }
      }
      .kpi .box {
        border: 1px dashed rgba(127, 127, 127, 0.45);
        border-radius: 12px;
        padding: 10px;
      }
      .kpi .val {
        font-size: 18px;
        font-weight: 700;
        margin-top: 2px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }
      th,
      td {
        text-align: left;
        padding: 10px 8px;
        border-bottom: 1px solid rgba(127, 127, 127, 0.25);
        font-size: 13px;
        vertical-align: top;
      }
      th {
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.04em;
        opacity: 0.8;
      }
      .badge {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 999px;
        border: 1px solid rgba(127, 127, 127, 0.35);
        font-size: 12px;
        opacity: 0.9;
      }
      .footer {
        margin-top: 14px;
        font-size: 12px;
        opacity: 0.82;
      }
      .btnrow {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 10px;
      }
      button {
        padding: 8px 10px;
        border-radius: 10px;
        border: 1px solid rgba(127, 127, 127, 0.45);
        background: rgba(127, 127, 127, 0.12);
        cursor: pointer;
      }
      button:hover {
        filter: brightness(1.05);
      }
      .small {
        font-size: 12px;
        opacity: 0.82;
      }
      .mono {
        font-family:
          ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
          "Liberation Mono", monospace;
      }
      .pill {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 999px;
        border: 1px solid rgba(127, 127, 127, 0.35);
      }
      .disabled {
        opacity: 0.55;
      }
      .zoom-row {
        border-top: 2px solid rgba(127, 127, 127, 0.5);
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>Kalkulator kosztów: streaming + nagrywanie + storage</h1>
      <div class="muted">
        <span class="pill mono">call-min / mies.</span> = rozmowy równoległe ×
        (h/dzień×60) × dni/tydz × tyg./mies. &nbsp;→&nbsp;
        <span class="pill mono">participant-min / mies.</span> = call-min × śr.
        liczba uczestników
        <br />
        Nagrywanie liczone osobno jako
        <span class="pill mono">recording-min / mies.</span> = call-min × %
        nagrywanych rozmów.
      </div>

      <div class="grid">
        <div class="card">
          <h2>Parametry obciążenia</h2>

          <div class="row">
            <label for="concurrentCalls">Równoległe rozmowy</label>
            <input
              id="concurrentCalls"
              type="number"
              min="0"
              step="1"
              value="40"
            />
          </div>

          <div class="row">
            <label for="hoursPerDay">Godzin dziennie</label>
            <input
              id="hoursPerDay"
              type="number"
              min="0"
              step="0.25"
              value="5"
            />
          </div>

          <div class="row">
            <label for="daysPerWeek">Dni w tygodniu</label>
            <input id="daysPerWeek" type="number" min="0" step="1" value="5" />
          </div>

          <div class="row">
            <label for="weeksPerMonth">Tygodni na miesiąc (średnio)</label>
            <input
              id="weeksPerMonth"
              type="number"
              min="1"
              step="0.01"
              value="4.33"
            />
          </div>

          <div class="row">
            <label for="avgParticipants">Śr. liczba uczestników na callu</label>
            <input
              id="avgParticipants"
              type="number"
              min="1"
              max="200"
              step="0.1"
              value="3"
            />
          </div>

          <div class="row">
            <label for="usdToPln">Kurs USD→PLN</label>
            <input
              id="usdToPln"
              type="number"
              min="0"
              step="0.01"
              value="4.00"
            />
          </div>

          <div class="hint">
            Jeśli masz mieszankę 1–5 osób, ustaw średnią. Koszt streamingu
            rośnie liniowo z liczbą uczestników.
          </div>
        </div>

        <div class="card">
          <h2>Streaming: stawki (USD / participant-minute)</h2>

          <div class="row">
            <label for="rateZoom">Zoom Video SDK (domyślnie 0.0035)</label>
            <input
              id="rateZoom"
              type="number"
              min="0"
              step="0.0001"
              value="0.0035"
            />
          </div>

          <div class="row">
            <label for="rateDaily">Daily (domyślnie 0.0040)</label>
            <input
              id="rateDaily"
              type="number"
              min="0"
              step="0.0001"
              value="0.0040"
            />
          </div>

          <div class="row">
            <label for="rateTwilio">Twilio Video (domyślnie 0.0040)</label>
            <input
              id="rateTwilio"
              type="number"
              min="0"
              step="0.0001"
              value="0.0040"
            />
          </div>

          <div class="row">
            <label for="rate100ms">100ms (domyślnie 0.0040)</label>
            <input
              id="rate100ms"
              type="number"
              min="0"
              step="0.0001"
              value="0.0040"
            />
          </div>

          <div class="row">
            <label for="rateAgora">Agora (np. HD ~0.00399)</label>
            <input
              id="rateAgora"
              type="number"
              min="0"
              step="0.0001"
              value="0.00399"
            />
          </div>

          <div class="btnrow">
            <button id="resetBtn" type="button">Reset do domyślnych</button>
            <button id="copyLinkBtn" type="button">
              Skopiuj link z parametrami
            </button>
          </div>

          <div class="footer">
            Ten panel liczy streaming (participant-minutes). Nagrywanie
            ustawiasz w kolejnym panelu.
          </div>
        </div>

        <div class="card" style="grid-column: 1 / -1">
          <h2>Nagrywanie (Zoom) — wybierz wariant albo wyłącz</h2>

          <div class="row">
            <label for="recordingMode">Tryb nagrywania</label>
            <select id="recordingMode">
              <option value="none">Brak nagrywania</option>
              <option value="uc">Universal Credit (per-minute)</option>
              <option value="payg">
                PAYG + add-on (miesięczny fee + pula + overage)
              </option>
            </select>
          </div>

          <div class="row">
            <label for="recordedShare">Jaki % rozmów jest nagrywany?</label>
            <input
              id="recordedShare"
              type="number"
              min="0"
              max="100"
              step="1"
              value="0"
            />
          </div>

          <div class="row">
            <label for="recordRateUc"
              >UC: stawka nagrania (USD / minuta nagrania)</label
            >
            <input
              id="recordRateUc"
              type="number"
              min="0"
              step="0.0001"
              value="0.0100"
            />
          </div>

          <div class="row">
            <label for="recordAddonMonthly"
              >PAYG: add-on miesięcznie (USD)</label
            >
            <input
              id="recordAddonMonthly"
              type="number"
              min="0"
              step="1"
              value="100"
            />
          </div>

          <div class="row">
            <label for="recordIncludedMinutes"
              >PAYG: pula minut nagrania w add-onie (min/mies.)</label
            >
            <input
              id="recordIncludedMinutes"
              type="number"
              min="0"
              step="100"
              value="30000"
            />
          </div>

          <div class="row">
            <label for="recordRateOverage"
              >PAYG: overage (USD / minuta po przekroczeniu puli)</label
            >
            <input
              id="recordRateOverage"
              type="number"
              min="0"
              step="0.0001"
              value="0.0150"
            />
          </div>

          <div class="row">
            <label for="storageUsdPerGb"
              >Storage: stawka (USD / GB / miesiąc)</label
            >
            <input
              id="storageUsdPerGb"
              type="number"
              min="0"
              step="0.01"
              value="0.25"
            />
          </div>

          <div class="row">
            <label for="gbPerHour"
              >Szacunek rozmiaru nagrania (GB / godzina)</label
            >
            <input
              id="gbPerHour"
              type="number"
              min="0"
              step="0.1"
              value="1.5"
            />
          </div>

          <div class="hint">
            Uwaga: GB/h zależy od jakości, liczby strumieni i kompresji. 1–2
            GB/h to często sensowny „placeholder”.
          </div>
        </div>

        <div class="card" style="grid-column: 1 / -1">
          <h2>Wyniki</h2>

          <div class="kpi">
            <div class="box">
              <div class="small">Call-minutes / miesiąc</div>
              <div class="val mono" id="callMinutes">—</div>
            </div>
            <div class="box">
              <div class="small">Participant-minutes / miesiąc</div>
              <div class="val mono" id="participantMinutes">—</div>
            </div>
            <div class="box">
              <div class="small">Recording-minutes / miesiąc</div>
              <div class="val mono" id="recordMinutes">—</div>
            </div>
          </div>

          <table id="resultsTable">
            <thead>
              <tr>
                <th>Dostawca</th>
                <th>Streaming (USD)</th>
                <th>Nagrywanie (USD)</th>
                <th>Storage (USD)</th>
                <th>Suma (USD)</th>
                <th>Suma (PLN)</th>
                <th>Koszt/godz (USD)</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>

          <div class="footer">
            Nagrywanie i storage są liczone tylko dla Zoom (pozostali dostawcy w
            tym kalkulatorze nie mają tu osobnych stawek). Jeśli chcesz, można
            dodać analogiczne pola per dostawca.
          </div>
        </div>
      </div>
    </div>

    <script>
      (function () {
        const $ = (id) => document.getElementById(id);

        const defaults = {
          concurrentCalls: 40,
          hoursPerDay: 5,
          daysPerWeek: 5,
          weeksPerMonth: 4.33,
          avgParticipants: 3,
          usdToPln: 4.0,

          rateZoom: 0.0035,
          rateDaily: 0.004,
          rateTwilio: 0.004,
          rate100ms: 0.004,
          rateAgora: 0.00399,

          recordingMode: "none",
          recordedShare: 0,

          recordRateUc: 0.01,

          recordAddonMonthly: 100,
          recordIncludedMinutes: 30000,
          recordRateOverage: 0.015,

          storageUsdPerGb: 0.25,
          gbPerHour: 1.5,
        };

        const providers = [
          { key: "zoom", name: "Zoom Video SDK", rateId: "rateZoom" },
          { key: "daily", name: "Daily", rateId: "rateDaily" },
          { key: "twilio", name: "Twilio Video", rateId: "rateTwilio" },
          { key: "100ms", name: "100ms", rateId: "rate100ms" },
          { key: "agora", name: "Agora", rateId: "rateAgora" },
        ];

        function fmtInt(n) {
          if (!isFinite(n)) return "—";
          return Math.round(n).toLocaleString("pl-PL");
        }
        function fmtMoney(n) {
          if (!isFinite(n)) return "—";
          return n.toLocaleString("pl-PL", {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2,
          });
        }
        function getNum(id) {
          const v = parseFloat($(id).value);
          return isFinite(v) ? v : 0;
        }

        function calcBase() {
          const concurrentCalls = getNum("concurrentCalls");
          const hoursPerDay = getNum("hoursPerDay");
          const daysPerWeek = getNum("daysPerWeek");
          const weeksPerMonth = getNum("weeksPerMonth");
          const avgParticipants = getNum("avgParticipants");

          const minutesPerDay = hoursPerDay * 60;
          const callMinutesMonth =
            concurrentCalls * minutesPerDay * daysPerWeek * weeksPerMonth;
          const participantMinutesMonth = callMinutesMonth * avgParticipants;

          return { callMinutesMonth, participantMinutesMonth };
        }

        function calcRecording(callMinutesMonth) {
          const mode = $("recordingMode").value;
          const share =
            Math.max(0, Math.min(100, getNum("recordedShare"))) / 100;
          const recordMinutesMonth = callMinutesMonth * share;

          // storage estimate
          const gbPerHour = getNum("gbPerHour");
          const storageUsdPerGb = getNum("storageUsdPerGb");
          const hoursRecorded = recordMinutesMonth / 60;
          const gbMonth = hoursRecorded * gbPerHour;
          const storageUsd = gbMonth * storageUsdPerGb;

          let recordUsd = 0;

          if (mode === "none" || recordMinutesMonth <= 0) {
            recordUsd = 0;
            return { mode, recordMinutesMonth, recordUsd, storageUsd, gbMonth };
          }

          if (mode === "uc") {
            const rate = getNum("recordRateUc");
            recordUsd = recordMinutesMonth * rate;
            return { mode, recordMinutesMonth, recordUsd, storageUsd, gbMonth };
          }

          if (mode === "payg") {
            const addon = getNum("recordAddonMonthly");
            const included = getNum("recordIncludedMinutes");
            const overRate = getNum("recordRateOverage");
            const overMinutes = Math.max(0, recordMinutesMonth - included);
            recordUsd = addon + overMinutes * overRate;
            return { mode, recordMinutesMonth, recordUsd, storageUsd, gbMonth };
          }

          return {
            mode,
            recordMinutesMonth,
            recordUsd: 0,
            storageUsd,
            gbMonth,
          };
        }

        function setRecordingUiState() {
          const mode = $("recordingMode").value;

          const ucIds = ["recordRateUc"];
          const paygIds = [
            "recordAddonMonthly",
            "recordIncludedMinutes",
            "recordRateOverage",
          ];

          ucIds.forEach((id) =>
            $(id)
              .closest(".row")
              .classList.toggle("disabled", mode !== "uc"),
          );
          paygIds.forEach((id) =>
            $(id)
              .closest(".row")
              .classList.toggle("disabled", mode !== "payg"),
          );

          // still editable, but visually de-emphasized; you can also disable inputs if you prefer
          ucIds.forEach((id) => ($(id).disabled = mode !== "uc"));
          paygIds.forEach((id) => ($(id).disabled = mode !== "payg"));
        }

        function render() {
          setRecordingUiState();

          const usdToPln = getNum("usdToPln");
          const { callMinutesMonth, participantMinutesMonth } = calcBase();
          const rec = calcRecording(callMinutesMonth);

          $("callMinutes").textContent = fmtInt(callMinutesMonth);
          $("participantMinutes").textContent = fmtInt(participantMinutesMonth);
          $("recordMinutes").textContent = fmtInt(rec.recordMinutesMonth);

          const tbody = $("resultsTable").querySelector("tbody");
          tbody.innerHTML = "";

          const rows = providers
            .map((p) => {
              const rate = getNum(p.rateId);
              const streamingUsd = participantMinutesMonth * rate;

              // Recording+storage only for Zoom in this version
              const recordUsd = p.key === "zoom" ? rec.recordUsd : 0;
              const storageUsd = p.key === "zoom" ? rec.storageUsd : 0;

              const totalUsd = streamingUsd + recordUsd + storageUsd;
              const totalPln = totalUsd * usdToPln;

              // Cost per hour of lessons (based on call-minutes)
              const hoursMonth = callMinutesMonth / 60;
              const costPerHour = hoursMonth > 0 ? totalUsd / hoursMonth : 0;

              return {
                ...p,
                rate,
                streamingUsd,
                recordUsd,
                storageUsd,
                totalUsd,
                totalPln,
                costPerHour,
              };
            })
            .sort((a, b) => a.totalUsd - b.totalUsd);

          for (const r of rows) {
            const tr = document.createElement("tr");
            if (r.key === "zoom") {
              tr.classList.add("zoom-row");
            }
            tr.innerHTML = `
        <td>${r.name} <span class="badge">${r.key}</span></td>
        <td class="mono">${fmtMoney(r.streamingUsd)}</td>
        <td class="mono">${fmtMoney(r.recordUsd)}</td>
        <td class="mono">${fmtMoney(r.storageUsd)}</td>
        <td class="mono"><b>${fmtMoney(r.totalUsd)}</b></td>
        <td class="mono"><b>${fmtMoney(r.totalPln)}</b></td>
        <td class="mono">${fmtMoney(r.costPerHour)}</td>
      `;
            tbody.appendChild(tr);
          }
        }

        function reset() {
          for (const [k, v] of Object.entries(defaults)) {
            $(k).value = v;
          }
          render();
        }

        function loadFromUrl() {
          const params = new URLSearchParams(location.search);
          for (const key of Object.keys(defaults)) {
            if (params.has(key)) $(key).value = params.get(key);
          }
        }

        function makeShareUrl() {
          const params = new URLSearchParams();
          for (const key of Object.keys(defaults))
            params.set(key, $(key).value);
          const base = location.origin + location.pathname;
          return base + "?" + params.toString();
        }

        async function copyLink() {
          const url = makeShareUrl();
          try {
            await navigator.clipboard.writeText(url);
            $("copyLinkBtn").textContent = "Skopiowano ✅";
            setTimeout(
              () =>
                ($("copyLinkBtn").textContent = "Skopiuj link z parametrami"),
              1200,
            );
          } catch {
            prompt("Skopiuj ręcznie:", url);
          }
        }

        // wiring
        const ids = Object.keys(defaults);
        ids.forEach((id) => $(id).addEventListener("input", render));
        $("recordingMode").addEventListener("change", render);
        $("resetBtn").addEventListener("click", reset);
        $("copyLinkBtn").addEventListener("click", copyLink);

        loadFromUrl();
        render();
      })();
    </script>
  </body>
</html>
